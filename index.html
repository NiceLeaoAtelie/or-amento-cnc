<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora CNC Paulo - Or√ßamentos</title>
    <style>
        :root { --primaria: #2c3e50; --secundaria: #3498db; --sucesso: #27ae60; --fundo: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--fundo); padding: 15px; margin: 0; }
        .frmcnc { max-width: 650px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: var(--primaria); border-bottom: 2px solid var(--secundaria); padding-bottom: 10px; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .campo { display: flex; flex-direction: column; }
        .campo-cheio { grid-column: span 2; }
        label { font-size: 11px; font-weight: bold; margin-bottom: 4px; color: #666; text-transform: uppercase; }
        input, select { padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; background: #fff; }
        input[readonly] { background: #f1f3f5; color: #495057; border: 1px solid #dee2e6; cursor: not-allowed; }
        .editavel { background: #fffef0; border: 1px solid #f1c40f; } /* Amarelo clarinho para indicar que pode mexer */
        .secao-titulo { grid-column: span 2; background: var(--primaria); color: white; padding: 6px 12px; border-radius: 4px; margin-top: 10px; font-size: 13px; }
        .btn-group { grid-column: span 2; display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 14px; }
        #btnSalvar { background: var(--sucesso); color: white; }
        #btnImprimir { background: var(--secundaria); color: white; }
        button:hover { opacity: 0.9; }
        .resultado-final { background: #2c3e50 !important; color: #fff !important; font-size: 20px !important; text-align: center; font-weight: bold !important; }
    </style>
</head>
<body>

<div class="frmcnc">
    <h2>Or√ßamento Corte CNC</h2>
    
    <div class="grid">
        <div class="campo campo-cheio">
            <label>Produto / Projeto:</label>
            <input type="text" id="txtproduto" placeholder="Nome do item">
        </div>

        <div class="secao-titulo">‚öôÔ∏è Tempo e Opera√ß√£o</div>
        <div class="campo">
            <label>Horas M√°quina:</label>
            <input type="number" id="txthoramaquina" step="0.01" value="0" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Valor Hora (R$ 1,50):</label>
            <input type="text" id="txttotalhoramaquina" readonly>
        </div>

        <div class="secao-titulo">ü™µ Material e Dimens√µes (mm)</div>
        <div class="campo campo-cheio">
            <label>Material:</label>
            <select id="lstnomematerial">
                <option value="pinus">Pinus</option>
                <option value="mdf6mm">MDF 6mm</option>
                <option value="mdf3mm">MDF 3mm</option>
                <option value="jequitiba">Jequitib√°</option>
                <option value="peroba">Peroba</option>
                <option value="ipe_rosa">Ip√™ Rosa</option>
            </select>
        </div>
        <div class="campo">
            <label>Valor M¬≥ (R$):</label>
            <input type="number" id="txtmetrocubico" value="0" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Espessura (mm):</label>
            <input type="number" id="txtespessura" value="0" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Largura (mm):</label>
            <input type="number" id="txtlargura" value="0" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Comprimento (mm):</label>
            <input type="number" id="txtcomprimento" value="0" oninput="calcular()">
        </div>

        <div class="secao-titulo">üí∞ Ajustes de Pre√ßo e Custos</div>
        <div class="campo">
            <label>M√£o de Obra (R$):</label>
            <input type="number" id="txtmaodeobra" class="editavel" value="8.50" step="0.50" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Margem / Lucro (%):</label>
            <input type="number" id="txtmargem_input" class="editavel" value="50" oninput="calcular()">
        </div>
        <div class="campo">
            <label>Custo Material:</label>
            <input type="text" id="txtcustomaterial" readonly>
        </div>
        <div class="campo">
            <label>Custo Total:</label>
            <input type="text" id="txtcustototal" readonly>
        </div>

        <div class="secao-titulo">üèÅ Resultado Final</div>
        <div class="campo">
            <label>Taxa Cart√£o (5,99%):</label>
            <input type="text" id="txttaxacartao" readonly>
        </div>
        <div class="campo">
            <label>Lucro Realizado:</label>
            <input type="text" id="txtvalor_margem" readonly>
        </div>
        
        <div class="campo campo-cheio">
            <label>Pre√ßo Sugerido de Venda:</label>
            <input type="text" id="txtprecovenda" class="resultado-final" readonly>
        </div>

        <div class="btn-group">
            <button id="btnSalvar" onclick="salvarOrcamento()">üíæ Salvar Planilha</button>
            <button id="btnImprimir" onclick="window.print()">üñ®Ô∏è PDF / Imprimir</button>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzu0g8Ycc_OdmfR1_bCX0zKKbaM9qJ1cwCJw7_99gxgl3j_xWu5B-RDZOD4BW5D20vo/exec"; // Cole o link do seu Google Script aqui

    function
